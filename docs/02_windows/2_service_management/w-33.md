# W-33: HTTP/FTP/SMTP 배너 차단

**분류**: 02_windows

**중요도**: 하

---

02. Windows 서버

Windows 서버 > 2. 서비스 관리

## 개요

### 점검 내용

HTTP/FTP/SMTP 서비스 배너 차단 적용 여부 점검

### 점검 목적

HTTP/FTP/SMTP 서비스 접속 배너를 통한 불필요한 정보 노출을 방지하기 위함

### 보안 위협

서비스 접속 배너가 차단되지 않는 경우 임의의 사용자가 HTTP, FTP, SMTP 접속 시도 시 노출되는 접속 배너 정보를 수집하여 악의적인 공격에 이용할 위험이 존재함

### 참고

-

## 점검 대상 및 판단 기준

### 대상

Windows NT, 2000, 2003, 2008, 2012, 2016, 2019, 2022

### 판단 기준

**✅ 양호**: HTTP, FTP, SMTP 접속 시 배너 정보가 보이지 않는 경우

**❌ 취약**: HTTP, FTP, SMTP 접속 시 배너 정보가 보이는 경우

## 조치 방법

사용하지 않는 경우 IIS 서비스 중지/사용 안 함, 사용 시 속성값 수정

### 조치 시 영향

일반적인 경우 영향 없음

## 점검 및 조치 사례

### HTTP

**[Server 헤더 제거]**

**Step 1) Microsoft 다운로드 센터에서 URL Rewrite 다운로드 후 설치**

https://www.iis.net/downloads/microsoft/url-rewrite

**Step 2) 제어판 > 관리 도구 > IIS(인터넷 정보 서비스) 관리자 > 해당 웹 사이트 > [URL 재작성]**

**Step 3) 작업 탭 > [서버 값 관리 – 서버 변수 보기...] > 서버 변수 이름 추가**

**[ 서버 변수 추가 ]**

**Step 4) [URL 재작성] > 작업 탭 > [규칙 추가...] > 아웃바운드 규칙 > 빈 규칙 > 다음 사항 적용**

- 이름(N): Remove Server - 검색 범위: 서버 변수 - 서버 변수 이름: RESPONSE_SERVER - 패턴(T): .*

**[ 아웃바운드 규칙 추가 ]**

**[X-Powered-By 헤더 제거]**

**Step 1) 제어판 > 관리 도구 > IIS(인터넷 정보 서비스) 관리자 > 해당 웹 사이트 > [HTTP 응답 헤더]**

**Step 2) [X-Powered-By] 설정 제거**

**[ X-Powered-By 헤더 제거 ]**

02. Windows 서버

### FTP

**Step 1) IIS(인터넷 정보 서비스) 관리자 > FTP 메시지 > 기본 배너 숨기기 설정**

**[ FTP 기본 배너 숨기기 설정 ]**

### SMTP

**Step 1) 시작 > 실행 > cmd > adsutil.vbs 파일이 있는 디렉터리로 이동**

- 명령어: cd C:\inetpub\AdminScripts - adsutil.vbs를 사용하기 위해 서버 관리자에서 역할 추가 필요 → ”웹 서버(IIS) > 관리 도구 > IIS 6 관리 호환성 > IIS 6 스크립팅 도구“ 설치 필요

**Step 2) IIS에서 서비스 중인 SMTP 서비스 목록 확인**

- 명령어: cscript adsutil.vbs enum /p smtpsvc

**Step 3) SMTP 서비스에 connectresponse 속성 값에서 배너 문구 수정**

- 명령어: cscript adsutil.vbs set smtpsvc/1/connectresponse “Banner Text”

**Step 4) SMTP 서비스 재시작**

- 명령어: net stop smtpsvc (중지) - 명령어: net start smtpsvc (시작)

