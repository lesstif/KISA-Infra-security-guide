# W-56: SMB 세션 중단 관리 설정

**분류**: Windows

**중요도**: 중

---

## 개요

### 점검 내용

Session 연결 중단 시 유휴 시간 설정 여부 점검

### 점검 목적

Session이 중단되기 전에 SMB(서버 메시지 블록) Session에서 보내야 하는 연속 유휴 시간을 결정하여 서비스 거부 공격 등에 악용되지 않도록 하기 위함

### 보안 위협

SMB Session에서는 서버 리소스를 사용하며, NULL Session 수가 많으면 서버 속도가 느려지거나 서버에 오류를 발생시킬 수 있으므로 공격자는 이를 악용하여 SMB Session을 반복 설정하여 서버의 SMB 서비스가 느려지거나 응답하지 않게 하여 서비스 거부 공격을 실행할 위험이 존재함

### 참고

!!! info "참고"
    Administrator는 해당 정책을 활성화하여 컴퓨터가 비활성 SMB Session을 중단하는 시점을 제어할 수 있으며, 클라이언트를 다시 시작하면 해당 Session은 자동으로 다시 연결됨. 해당 정책의 값을 0으로 설정하면 가능한 한 빨리 유휴 Session 연결은 끊어지며, 최댓값은 99999(208일)로 사실상 정책 설정 해제를 의미함

!!! info "SMB(서버 메시지 블록)"
    LAN이나 컴퓨터 간의 통신에서 데이터 송수신을 하기 위한 프로토콜

## 점검 대상 및 판단 기준

### 대상

Windows NT, 2000, 2003, 2008, 2012, 2016, 2019, 2022

### 판단 기준

**✅ 양호**: "로그온 시간이 만료되면 클라이언트 연결 끊기" 정책을 "사용"으로, "세션 연결을 중단하기 전에 필요한 유휴 시간" 정책을 "15분" 이하로 설정한 경우

**❌ 취약**: "로그온 시간이 만료되면 클라이언트 연결 끊기" 정책이 "사용 안 함" 또는 "세션 연결을 중단하기 전에 필요한 유휴 시간" 정책이 "15분" 초과로 설정한 경우

## 조치 방법

-   "로그인 시간이 만료되면 클라이언트 연결 끊기" 정책 "사용" 설정
-   "세션 연결을 중단하기 전에 필요한 유휴 시간" 정책 "15분" 이하로 설정

### 조치 시 영향

일반적인 경우 영향 없음

## 점검 및 조치 사례

### Windows NT, 2000

1.  **시작 > 실행 > `SECPOL.MSC` > 로컬 정책 > 보안 옵션**
2.  **"로그인 시간이 만료되면 클라이언트 연결 끊기" 정책 "사용" 설정**
    -   "세션 연결을 중단하기 전에 필요한 유휴 시간" 정책 "15분" 이하로 설정

### Windows 2003, 2008, 2012, 2016, 2019, 2022

1.  **시작 > 제어판 > 관리 도구 > 로컬 보안 정책 > 로컬 정책 > 보안 옵션**
2.  **"Microsoft 네트워크 서버: 로그온 시간이 만료되면 클라이언트 연결 끊기" 정책 "사용" 설정**
    -   "Microsoft 네트워크 서버: 세션 연결을 중단하기 전에 필요한 유휴 시간" 정책 "15분" 이하로 설정

**[ 로그온 시간이 만료되면 클라이언트 연결 끊기 "사용" 설정 ]**

**[ 세션을 중단하기 전에 필요한 유휴 시간 "15분" 설정 ]**

