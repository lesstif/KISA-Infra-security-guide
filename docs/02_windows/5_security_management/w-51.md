# W-51: SAM 계정과 공유의 익명 열거 허용 안 함

**분류**: 02_windows

**중요도**: 상

---

02. Windows 서버

Windows 서버 > 5. 보안 관리

## 개요

### 점검 내용

“SAM 계정과 공유의 익명 열거 허용 안 함” 정책 설정 여부 점검

### 점검 목적

익명 사용자에 의한 악의적인 계정 정보 탈취를 방지하기 위함

### 보안 위협

Windows에서는 익명의 사용자가 도메인 계정(사용자, 컴퓨터 및 그룹)과 네트워크 공유 이름의 열거 작업을 수행할 수 있으므로 SAM(보안 계정 관리자) 계정과 공유의 익명 열거가 허용될 경우 악의적인 사용자가 계정 이름 목록을 확인하고 이 정보를 사용하여 암호를 추측하거나 사회 공학적 공격기법을 수행할 위험이 존재함

### 참고

!!! info "방화벽과 라우터에서 135~139(TCP, UDP) Port 차단을 통해 외부로부터의 위협을 차단함"

!!! info "네트워크 및 전화 접속 연결 > 로컬 영역 > 등록 정보 > 고급 > 고급 설정 > Microsoft 네트워크 파일"

및 프린트 공유를 해제해야 함

## 점검 대상 및 판단 기준

### 대상

Windows NT, 2000, 2003, 2008, 2012, 2016, 2019, 2022

### 판단 기준

**✅ 양호**: “SAM 계정과 공유의 익명 열거 허용 안 함”이 “사용”으로 설정된 경우

**❌ 취약**: “SAM 계정과 공유의 익명 열거 허용 안 함”이 “사용 안 함”으로 설정된 경우

## 조치 방법

레지스트리 값 또는, 로컬 보안 정책 설정

### 조치 시 영향

Active Directory, Clustered system에서는 적용 시 영향 있음

## 점검 및 조치 사례

### Windows NT

**Step 1) 시작 > 제어판 > 관리 도구 > 레지스트리 편집기**

HKLM\SYSTEM\CurrentControlSet\Control\LSA

**Step 2) RestrictAnonymous 값을 “1”로 설정**

### Windows 2000

**Step 1) 시작 > 실행 > SECPOL.MSC > 로컬 정책 > 보안 옵션**

**Step 2) “익명의 연결에 추가적인 제한”에 “명백한 익명의 사용 권한이 없으면 액세스 제한” 선택**

### Windows 2003, 2008, 2012, 2016, 2019, 2022

**Step 1) 시작 > 제어판 > 관리 도구 > 로컬 보안 정책 > 로컬 정책 > 보안 옵션**

**Step 2) "네트워크 액세스 : SAM 계정과 공유의 익명 열거 허용 안 함”과 “네트워크 액세스 : SAM 계정의 익명**

열거 허용 안 함”에 “사용” 선택

**[ 익명 열거 허용 안 함 사용 설정 ]**

