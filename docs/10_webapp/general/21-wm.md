# WM: 21. 불필요한 Method 악용

**분류**: Web Application(웹)

**중요도**: 상

---

### JWT(JSON Web Token)

**Step 1) 사용자 인증 및 상태 유지를 위해 JWT(JSON Web Token)가 사용되는지 확인**

(JWT는 일반적으로 Authorization 헤더에 포함되고, 경우에 따라 Cookie 헤더에 포함, 또는 POST 데이터로 전송할 수 있음)

**[ JWT 토큰 사용 유무 확인 ]**

**Step 2) JWT(JSON Web Token)의 헤더와 페이로드 부분을 각각 Base64 디코딩하여 내용을 확인할 수 있으며,**

안전한 알고리즘을 사용하는지, 토큰 만료 설정이 적절하게 되었는지, 민감정보가 노출되는지 등을 확인

**[ JWT 토큰 디코딩 시 민감정보 노출 유무 확인 ]**

**Step 3) 페이로드 변조 후 서명을 삭제하거나 None 알고리즘으로 변조하였을 때 토큰이 유효하여 타 계정의**

권한 탈취가 가능한지 확인

**[ JWT 토큰 익스플로잇 가능성 유무 확인 ]**

**조치 방법**

### 세션 고정 및 예측

1. 공격자가 하나의 유효한 세션 ID를 추측하는 것이 불가능에 가깝도록 길고 복잡한 세션 ID를 생성하여야

하며, 새 로그인 시 기존 세션 ID를 폐기하고 새로운 세션 ID로 발급해야 하며, 이용 중인 계정에 대해 접속 IP와 디바이스 정보를 통해 동시 세션 로그인 여부를 검사해야함

!!! info "Java"

세션 생성 로직 예시 @RequestMapping("/login") public String login(HttpServletRequest request) { request.changeSessionId(); // 신규 로그인 시 세션 ID 변경 return "redirect:/home"; } //Spring Security 설정에서 세션 고정 방지 및 세션 ID 생성 @Override protected void configure(HttpSecurity http) throws Exception { http.sessionManagement() .sessionFixation().migrateSession() .sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED) .maximumSessions(1).maxSessionsPreventsLogin(false) .expiredUrl("/login?expired"); }

!!! info "ASP.NET"

web.config 파일 설정을 통한 불규칙 세션 ID 발급 설정 예시 <system.web> ... <!--세션 고정 방지 --> <sessionState regenerateExpiredSessionId="true"> ... <!--세션 예측 방지 --> <machineKey validationKey="AutoGenerate,IsolateApps" decryptionKey="AutoGenerate,IsolateApps" validation="HMACSHA512"

