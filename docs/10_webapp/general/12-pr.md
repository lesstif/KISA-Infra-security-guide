# PR: 12. 취약한 비밀번호 복구 절차

**분류**: Web Application(웹)

**중요도**: 상

---

!!! info "Java"

§ SecureRandom : 난수를 생성하는 데 사용되는 클래스로, 일반 Random 클래스와 달리 시드를 명시적으로 설정할 수 없으므로 키 생성, 보안 토큰 등 보안이 필요한 애플리케이션의 경우 SecureRandom 사용 SecureRandom 클래스를 사용하여 안전한 임시 비밀번호를 생성하는 예시 private static final String CHARACTERS = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"; //대소문자 영문, 숫자 조합으로 12자리의 난수 생성 규칙 정의 private static final int PASSWORD_LENGTH = 12; private String generateTemporaryPassword() { SecureRandom secureRandom = new SecureRandom(); StringBuilder password = new StringBuilder(PASSWORD_LENGTH); for (int i = 0; i < PASSWORD_LENGTH; i++) { int randomIndex = secureRandom.nextInt(CHARACTERS.length()); password.append(CHARACTERS.charAt(randomIndex)); } return password.toString() }  //임시 비밀번호로 사용될 난수 생성

!!! info "ASP.NET"

§ RNGCryptoServiceProvider  : 난수를 생성하는 데 사용되는 클래스로, 사전에 정의된 문자 집합에서 안전한 암호화 알고리즘을 기반으로 문자를 선택하여 복잡한 난수를 생성 RNGCryptoServiceProvider 클래스를 사용하여 안전한 임시 비밀번호를 생성하는 예시 protected void btnCheckRandom_Click(object sender, EventArgs e) { lblRandomNumber.Text = GenerateAlphanumericRandom(12); // 자리수 정의(12) } private string GenerateAlphanumericRandom(int length) { const string chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"; //대소문자 영문, 숫자 조합으로 생성 규칙 정의 StringBuilder result = new StringBuilder(length); byte[] randomBytes = new byte[4 * length]; using (var rng = new RNGCryptoServiceProvider()) {

!!! info "PHP"

§ rand 메소드 보다 random_int 메소드가 암호학적으로 안전한 난수를 생성 (PHP 7.0 버전부터 사용 가능) random_int() 메소드를 사용하여 안전한 임시 비밀번호를 생성하는 예시 ... function generateRandomPassword($length = 12) { $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()'; $charactersLength = strlen($characters); $randomPassword = ''; for ($i = 0; $i < $length; $i++) { $randomPassword .= $characters[random_int(0, $charactersLength - 1)]; } return $randomPassword; } .... if ($_SERVER['REQUEST_METHOD'] == 'POST') { //세션 정보와 'userid' 값이 일치하는지 검증 $userid = $_POST[‘userid’]; $email = $_POST[‘email’]; if (isset($_SESSION['userid']) && $_SESSION['userid'] === $userid) { $temporaryPassword = generateRandomPassword(); updateUserPassword($userid, password_hash($temporaryPassword, PASSWORD_DEFAULT)); if (sendPasswordEmail($email, $temporaryPassword)) { echo "귀하의 이메일로 임시 비밀번호가 발송되었습니다."; .... rng.GetBytes(randomBytes); for (int i = 0; i < length; i++) { uint randomInt = BitConverter.ToUInt32(randomBytes, i * 4); result.Append(chars[(int)(randomInt % (uint)chars.Length)]); } } return result.ToString(); } ...

