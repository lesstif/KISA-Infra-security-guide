# AE: 19. 관리자페이지 노출

**분류**: Web Application(웹)

**중요도**: 상

---

!!! info "ASP.NET"

§ 경로 정규화: 다양한 형태의 파일 경로를 표준화된 형식으로 변환시키는 과정으로 ../ 와 같은 상대 경로 참조를 해석하고 제거하여 허가되지 않은 디렉터리 접근을 차단함 경로 정규화를 통한 경로 검증 로직 예시 filename = Path.GetFileName(filename); var uploadsFolder = Path.Combine(_environment.WebRootPath, "uploads"); //지정된 업로드 폴더와 정규화된 파일 이름을 결합 var filePath = Path.GetFullPath(Path.Combine(uploadsFolder, filename)); ... if (!filePath.StartsWith(uploadsFolder, StringComparison.OrdinalIgnoreCase)) { //해당 파일이 업로드 폴더 내 존재하는지 검증 return BadRequest("Invalid file path."); } ...

!!! info "PHP"

§ php.ini 에서 magic_quotes_gpc를 On으로 설정하여 .\./ 와 같은 역 슬러시 문자 입력 시 치환되도록 설정이 가능하나, PHP 5.4.0 이후로는 해당 기능이 제거됨 § filter_input() 함수를 이용해 사용자 입력 데이터를 안전하게 필터링할 수 있으며, realpath() 함수를 이용해 경로를 정규화하고 실제 경로를 반환하므로, 이를 통해 상위 경로 탐색을 방지함 경로 정규화를 통한 경로 검증 로직 예시 // 파일 다운로드 요청 처리 if (isset($_GET['file'])) { // file 파라미터 검증 및 처리 $file = filter_input(INPUT_GET, 'file', FILTER_SANITIZE_STRING); $filePath = realpath('../uploads/' . $file); //지정된 업로드 디렉터리에 실제 존재하는지 확인 // 파일 경로가 지정된 디렉토리 내에 있는지 확인 if ($filePath && strpos($filePath, realpath('../uploads/')) === 0) { downloadFile($filePath); } else { echo "잘못된 파일 경로입니다."; exit; ... IS

16. 불충분한 세션 관리

## 개요

### 점검 내용

세션 만료 기간 설정, 예측 가능한 세션 ID 생성, 고정된 세션 ID 발행 등 세션 관리 정책을 점검하고, 인증 토큰(JWT 등) 사용 시에도 안전한 서명 알고리즘 사용 여부, 안전한 비밀 키 사용 여부, 토큰 만료 등의 정책 점검

### 점검 목적

사용자의 세션 ID를 적절히 관리하여 공격자가 불법적으로 접근하거나 비인가적인 세션 탈취를 차단하기 위함

### 보안 위협

사용자에게 발급되는 세션 ID가 만료되지 않거나, 고정 및 예측 가능한 형태일 경우, 공격자는 해당 세션 ID를 탈취하여 타 사용자나 시스템에 무단 접근할 수 있으며, 이로 인해 중요 데이터의 무결성이 훼손될 수 있음

### 참고

!!! info "세션(Session)"
    일정 시간 동안 같은 사용자(브라우저)로 부터 들어오는 일련의 요구를 하나의

상태로 보고 그 상태를 일정하게 유지시키는 기술

!!! info "JSON Web Token (JWT)"
    헤더, 페이로드, 서명으로 구성되는 JSON 객체 형식이며, 사용자

정보가 클라이언트에 저장되고 서버에 요청 시마다 전송하여 인증 상태를 유지시키는 기술

!!! info "소스코드 및 취약점 점검 필요"

## 점검 대상 및 판단 기준

### 대상

웹 애플리케이션 소스코드, 웹 애플리케이션 서버

### 판단 기준

**✅ 양호**: 추측 불가능한 세션 ID가 발급되고, 세션 종료 시간이 설정되어 있는 경우

**❌ 취약**: 세션 ID가 일정한 패턴으로 발급되거나 세션 종료 시간이 설정되지 않아 세션 재사용이 가능한

경우

## 조치 방법

추측 불가능한 세션 ID가 발급되도록 로직을 구현하고, 세션 종료 시간 설정 또는 자동 로그아웃 기능을 구현하여 사이트 특성에 맞게 적정 시간을 설정

### 조치 시 영향

일반적인 경우 영향 없음

## 점검 및 조치 사례

**점검 방법**

### 세션(Session)

**Step 1) 로그인 과정에서 발급받은 세션 ID를 확인하고 로그아웃 후 재 로그인 시 각각 발급받은 세션 ID에 대해**

일정한 패턴이 존재하는지 검증 § 각각 발급받은 세션 ID를 확인하여 예측 가능한 패턴으로 생성되는지 검증 § 각각 발급받은 세션 ID를 확인하여 고정된 값으로 생성되는지 검증

**[ 세션 발급 시 동일 패턴 유무 확인 ]**

**Step 2) 로그인 후 웹 페이지 사용을 중지한 상태로 일정 시간이 경과하였을 때 세션이 유지되는지 확인**

**[ 일정 시간 경과 시 세션 만료 유무 확인 ]**

