# U-46: 일반 사용자의 메일 서비스 실행 방지

**분류**: 01_unix

**중요도**: 상

---

## 개요

### 점검 내용

SMTP 서비스 사용 시 일반 사용자의 q 옵션 제한 여부 점검

### 점검 목적

일반 사용자의 q 옵션을 제한하여 메일 서비스 설정 및 메일 큐를 강제적으로 drop 시킬 수 없게 하여 비인가자에 의한 SMTP 서비스 오류 방지하기 위함

### 보안 위협

일반 사용자가 q 옵션을 이용해서 메일 큐, 메일 서비스 설정을 보거나 메일 큐를 강제적으로 drop 시킬 수 있어 악의적으로 SMTP 서버의 오류를 발생시킬 위험이 존재함

### 참고

!!! info "SMTP(Simple Mail Transfer Protocol)"
    인터넷상에서 전자우편(E-mail)을 전송할 때 이용하게 되는 표준 통신 규약을 말함

## 점검 대상 및 판단 기준

### 대상

SOLARIS, LINUX, AIX, HP-UX 등

### 판단 기준

**✅ 양호**: 일반 사용자의 메일 서비스 실행 방지가 설정된 경우

**❌ 취약**: 일반 사용자의 메일 서비스 실행 방지가 설정되어 있지 않은 경우

## 조치 방법

* 메일 서비스를 사용하지 않는 경우 서비스 중지 및 비활성화 설정
* 메일 서비스 사용 시 메일 서비스의 q 옵션 제한 설정

### 조치 시 영향

일반적인 경우 영향 없음

## 점검 및 조치 사례

### SOLARIS, LINUX, AIX, HP-UX

#### Sendmail

1. **`/etc/mail/sendmail.cf` 파일 내 PrivacyOptions 설정에 restrictqrun 값 추가**

    ```bash
    PrivacyOptions = authwarnings, novrfy, noexpn, restrictqrun
    ```

2. **Sendmail 서비스 재시작**

#### Postfix

1. **일반 사용자 실행 권한 확인**

    ```bash
    # ls -l /usr/sbin/postsuper
    ```

2. **일반 사용자 실행 권한 제거**

    ```bash
    # chmod o-x /usr/sbin/postsuper
    ```

#### Exim

1. **일반 사용자 실행 권한 확인**

    ```bash
    # ls -l /usr/sbin/exiqgrep
    ```

2. **일반 사용자 실행 권한 제거**

    ```bash
    # chmod o-x /usr/sbin/exiqgrep
    ```

