# U-62: 로그인 시 경고 메시지 설정

**분류**: 01_unix

**중요도**: 하

---

UNIX > 3. 서비스 관리

## 개요

### 점검 내용

서버 및 서비스에 로그온 시 불필요한 정보 차단 설정 및 불법적인 사용에 대한 경고 메시지 출력 여부 점검

### 점검 목적

비인가자들에게 서버에 대한 불필요한 정보를 제공하지 않고, 서버 접속 시 관계자만 접속해야 한다는 경각심을 심어 주기 위함

### 보안 위협

로그온 시 경고 메시지가 설정되어 있지 않을 경우, 기본 설정값엔 서버 OS 버전 및 서비스 버전이 비인가자에게 노출되어 해당 정보를 통해 서비스의 취약점을 이용하여 공격을 시도할 위험이 존재함

### 참고

!!! info "로그온 시 경고 메시지는 공격자의 활동을 주시하고 있다는 생각을 상기시킴으로써 간접적으로"

공격 피해를 감소시키는 효과를 줄 수 있음

## 점검 대상 및 판단 기준

### 대상

SOLARIS, LINUX, AIX, HP-UX 등

### 판단 기준

**✅ 양호**: 서버 및 Telnet, FTP, SMTP, DNS 서비스에 로그온 시 경고 메시지가 설정된 경우

**❌ 취약**: 서버 및 Telnet, FTP, SMTP, DNS 서비스에 로그온 시 경고 메시지가 설정되어 있지 않은 경우

## 조치 방법

Telnet, FTP, SMTP, DNS 서비스를 사용하는 경우 설정 파일을 통해 로그온 시 경고 메시지 설정

### 조치 시 영향

일반적인 경우 영향 없음

## 점검 및 조치 사례

### SOLARIS

**[서버]**

**Step 1) /etc/motd 파일과 /etc/issue 파일 내에 로그온 시 경고 메시지 입력**

**[Telnet]**

**Step 1) /etc/issue.net 파일 내에 로그온 시 경고 메시지 입력**

**Step 2) /etc/default/telnetd 파일 내에 배너 경고 메시지 수정**

BANNER=<로그온 시 경고 메시지>

**[SSH]**

**Step 1) /etc/motd 파일 내 로그온 시 경고 메시지 입력**

**Step 2) /etc/ssh/sshd_config 파일 내에 배너 경고 메시지 수정**

01. Unix 서버

Banner <경고 메시지가 작성된 파일 경로>

**Step 3) <SSH Banner 설정 파일 경로> 파일 내에 로그온 경고 메시지 수정**

(일반적으로 /etc/issue 또는 /etc/issue.net 파일 사용)

**[Sendmail]**

**Step 1) /etc/mail/sendmail.cf 파일 내에 SmtpGreetingMessage 로그온 경고 메시지 수정**

SmtpGreetingMessage=<로그온 시 경고 메시지>

**Step 2) 설정 적용 및 재시작**

# svcadm refresh sendmail

**[Postfix]**

**Step 1) /etc/postfix/main.cf 파일 내에 SMTP 서버 로그온 경고 메시지 수정**

smtpd_banner = <로그온 시 경고 메시지>

**Step 2) 설정 적용 및 재시작**

# svcadm refresh postfix

**[Exim]**

**Step 1) /exim/exim.conf 파일 내에 SMTP 서버 로그온 경고 메시지 수정**

smtp_banner = <로그온 시 경고 메시지>

**Step 2) 설정 적용 및 재시작**

# svcadm refresh exim

**[기본 FTP]**

**Step 1) /etc/default/ftpd 파일 내에 경고 메시지 수정**

BANNER=“<로그온 시 경고 메시지>”

**[vsFTP]**

**Step 1) /etc/vsftpd/vsftpd.conf 파일 내에 FTP 서버 로그온 경고 메시지 수정**

ftpd_banner=<변경할 배너>

**Step 2) 설정 적용 및 재시작**

# svcadm refresh vsftpd

**[ProFTP]**

**Step 1) /etc/proftpd/proftpd.conf 파일 내에 welcome.msg 파일 경로 확인 및 수정**

DisplayLogin <welcome.msg 파일 경로>

**Step 2) <welcome.msg 파일 경로> 파일 내에 설정된 FTP 서버 로그온 경고 메시지 수정**

**Step 3) 설정 적용 및 재시작**

# svcadm refresh proftpd

### LINUX

**[서버]**

**Step 1) /etc/motd, /etc/issue 파일 내에 경고 메시지 수정**

**[Telnet]**

**Step 1) /etc/issue.net 파일 내에 로그온 경고 메시지 수정**

**[SSH]**

**Step 1) /etc/ssh/sshd_config 파일 내에 설정된 배너 경고 메시지 파일 경로 확인 및 수정**

Banner /etc/issue.net <경고 메시지가 작성된 파일 경로>

**Step 2) <SSH 배너 설정 파일 경로> 파일 내에 경고 메시지 수정**

(일반적으로 /etc/issue 또는 /etc/issue.net 파일 사용)

**Step 3) 설정 적용 및 재시작**

# systemctl restart sshd

**[Sendmail]**

**Step 1) /etc/mail/sendmail.cf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

SmtpGreetingMessage=<경고 메시지>

**Step 2) 설정 적용 및 재시작**

# systemctl restart sendmail

**[Postfix]**

**Step 1) /etc/postfix/main.cf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

smtpd_banner = <경고 메시지>

01. Unix 서버

**Step 2) 설정 적용 및 재시작**

# systemctl restart postfix

**[Exim]**

**Step 1) /exim/exim.conf 또는 /exim4/exim4.conf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

**Step 2) /exim/exim.conf 또는 /exim4/exim4.conf 파일 내에 설정된 SMTP 경고 메시지 수정**

smtp_banner = <경고 메시지>

**Step 3) 설정 적용 및 재시작**

# systemctl restart exim

**[vsFTP]**

**Step 1) /etc/vsftpd.conf 또는 /etc/vsftpd/vsftpd.conf 파일 내에 설정된 FTP 서버 로그온 시 경고 메시지 수정**

ftpd_banner=<경고 메시지>

**Step 2) 설정 적용 및 재시작**

# systemctl restart vsftpd

**[ProFTP]**

**Step 1) /etc/proftpd.conf 또는 /etc/proftpd/proftpd.conf 파일 내에 설정된 welcome.msg 파일 경로 확인 및 수정**

DisplayLogin <welcome.msg 파일 경로>

**Step 2) <welcome.msg 파일 경로> 파일 내에 설정된 FTP 서버 로그온 시 경고 메시지 수정**

**Step 3) 설정 적용 및 재시작**

# systemctl restart proftpd

**[DNS]**

**Step 1) /etc/named.conf 또는 /etc/bind/named.conf.options 파일 내에 설정된 경고 메시지 수정**

version <경고 메시지>;

**Step 2) 설정 적용 및 재시작**

# systemctl restart named

### AIX

**[서버]**

**Step 1) /etc/motd, /etc/issue 파일 내에 설정된 서버 로그온 경고 메시지 수정**

**[Telnet]**

**Step 1) /etc/security/login.cfg 파일 내에 설정된 경고 메시지 수정**

default: ~~이하 생략~~ herald=<경고 메시지>

**[SSH]**

**Step 1) /etc/ssh/sshd_config 파일 내에 설정된 경고 메시지 파일 경로 확인 및 수정**

Banner <경고 메시지가 작성된 파일 경로>

**Step 2) <SSH 배너 설정 파일 경로> 파일 내에 설정된 경고 메시지 수정**

(일반적으로 /etc/issue 또는 /etc/issue.net 파일 사용)

**Step 3) SSH 서비스 중지 및 실행**

# stopsrc -s sshd # startsrc -s sshd

**[Sendmail]**

**Step 1) /etc/mail/sendmail.cf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

SmtpGreetingMessage=<경고 메시지>

**Step 2) Sendmail 서비스 중지 및 실행**

# stopsrc -s sendmail # startsrc -s sendmail

**[Postfix]**

**Step 1) /etc/postfix/main.cf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

smtpd_banner = <경고 메시지>

**Step 2) Postfix 서비스 재시작**

# kill -1 <PID>

01. Unix 서버

**[Exim]**

**Step 1) /exim/exim.conf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

smtp_banner = <경고 메시지>

**Step 2) Exim 서비스 재시작**

# kill -1 <PID>

**[기본 FTP]**

**Step 1) 메시지 카탈로그 파일 생성**

# dspcat -g /usr/lib/nls/msg/en_US/ftpd.cat > /tmp/ftpd.msg

**Step 2) /tmp/ftpd.msg 파일 내에 설정된 FTP 서버 로그온 시 경고 메시지 수정**

<변경할 배너>

**Step 3) ftpd.cat 파일 생성**

# gencat /usr/lib/nls/msg/en_US/ftpd.cat /tmp/ftpd.msg

**[vsFTP]**

**Step 1) /etc/vsftpd.conf 파일 내에 설정된 FTP 서버 로그온 시 경고 메시지 수정**

ftpd_banner=<경고 메시지>

**Step 2) vsFTP 서비스 재시작**

# kill -1 <PID>

**[ProFTP]**

**Step 1) /etc/proftpd.conf 파일 내에 설정된 welcome.msg 파일 경로 확인 및 수정**

DisplayLogin <welcome.msg 파일 경로>

**Step 2) <welcome.msg 파일 경로> 파일 내에 설정된 FTP 서버 로그온 시 경고 메시지 수정**

**Step 3) ProFTP 서비스 재시작**

# kill -1 <PID>

**[DNS]**

**Step 1) /etc/named.conf 파일 내에 설정된 경고 메시지 수정**

version <경고 메시지>;

**Step 2) DNS 서비스 중지 및 실행**

# stopsrc –s named # startsrc -s named

### HP-UX

**[서버]**

**Step 1) /etc/motd, /etc/issue 파일 내에 설정된 로그온 경고 메시지 수정**

**[Telnet]**

**Step 1) /etc/inetd.conf 파일 내에 설정된 경고 메시지 파일 경로 확인 및 수정**

telnet stream tcp6 nowait root /usr/lbin/telnetd telnetd -b /etc/issue 또는 <Telnet 배너 설정 파일 경로>

**Step 2) <Telnet 배너 설정 파일 경로> 파일 내에 설정된 경고 메시지 수정**

(일반적으로 /etc/issue 파일 사용)

**Step 3) inetd 설정 적용**

# inetd –c

**[SSH]**

**Step 1) /etc/ssh/sshd_config 파일 내에 설정된 경고 메시지 파일 경로 확인 및 수정**

Banner <경고 메시지가 작성된 파일 경로>

**Step 2) <SSH 배너 설정 파일 경로> 파일 내에 설정된 경고 메시지 수정**

(일반적으로 /etc/issue 또는 /etc/issue.net 파일 사용)

**Step 3) SSH 서비스 재시작**

# kill -1 <PID>

**[Sendmail]**

**Step 1) /etc/mail/sendmail.cf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

SmtpGreetingMessage=<경고 메시지>

**Step 2) Sendmail 서비스 재시작**

# kill –1 <PID>

01. Unix 서버

**[Postfix]**

**Step 1) /etc/postfix/main.cf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

smtpd_banner = <경고 메시지>

**Step 2) Postfix 서비스 재시작**

# kill -1 <PID>

**[Exim]**

**Step 1) /exim/exim.conf 파일 내에 설정된 SMTP 서버 로그온 시 경고 메시지 수정**

smtp_banner = <경고 메시지>

**Step 2) Exim 서비스 재시작**

# kill -1 <PID>

**[기본 FTP]**

**Step 1) /etc/inetd.conf 파일 내에 설정된 FTP 설정 파일 경로 확인 및 수정**

ftp stream tcp nowait root /usr/lbin/ftpd ftpd –a /etc/ftpd/ftpaccess

**Step 2) <기본 FTP 배너 설정 파일 경로> 파일 내에 경고 메시지 수정**

**Step 3) /etc/ftpd/ftpaccess 파일 내에 설정값 수정**

**[Wu-ftpd v2.4 미만인 경우]**

suppresshostname yes suppressversion yes banner <경고 메시지가 작성된 파일 경로>

**[Wu-ftpd v2.4 이상인 경우]**

greeting terse banner <경고 메시지가 작성된 파일 경로> # cp /usr/newconfig/etc/ftpd/examples/ftpaccess /etc/ftpd/ftpaccess

**Step 4) inetd 설정 적용**

# inetd -c

**[vsFTP]**

**Step 1) /etc/vsftpd.conf 파일 내에 설정된 FTP 서버 로그온 시 경고 메시지 수정**

ftpd_banner=<경고 메시지>

**Step 2) vsFTP 서비스 재시작**

# kill -1 <PID>

**[ProFTP]**

**Step 1) /etc/proftpd.conf 파일 내에 설정된 welcome.msg 파일 경로 확인 및 수정**

DisplayLogin <welcome.msg 파일 경로>

**Step 2) <welcome.msg 파일 경로> 파일 내에 설정된 FTP 서버 로그온 시 경고 메시지 수정**

**Step 3) ProFTP 서비스 재시작**

# kill -1 <PID>

**[DNS]**

**Step 1) /etc/named.conf 파일 내에 설정된 경고 메시지 확인**

version <경고 메시지>;

**Step 2) DNS 서비스 실행**

# kill -1 <PID>

