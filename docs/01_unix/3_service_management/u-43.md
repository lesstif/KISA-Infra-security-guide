# U-43: NIS, NIS+ 점검

**분류**: 01_unix

**중요도**: 상

---

## 개요

### 점검 내용

안전하지 않은 NIS 서비스의 비활성화, 안전한 NIS+ 서비스의 활성화 여부 점검

### 점검 목적

안전하지 않은 NIS 서비스를 비활성화하고 안전한 NIS+ 서비스를 활성화하여 시스템의 보안성을 높이기 위함

### 보안 위협

NIS 서비스가 활성화된 경우, 비인가자가 타 시스템의 root 권한까지 탈취할 수 있는 위험이 존재함

### 참고

!!! info "참고"
    NIS 주 서버는 정보표를 소유하여 NIS 대응 파일들로 변환하고, 이 대응 파일들이 네트워크를 통해 제공됨으로써 모든 컴퓨터에 정보가 갱신되도록 함. 네트워크를 통한 공유로부터 관리자와 사용자들에게 일관성 있는 시스템 환경을 제공함

## 점검 대상 및 판단 기준

### 대상

SOLARIS, LINUX, AIX, HP-UX 등

### 판단 기준

**✅ 양호**: NIS 서비스가 비활성화되어 있거나, 불가피하게 사용 시 NIS+ 서비스를 사용하는 경우

**❌ 취약**: NIS 서비스가 활성화된 경우

## 조치 방법

NIS 관련 서비스 비활성화 설정

### 조치 시 영향

일반적인 경우 영향 없음

## 점검 및 조치 사례

### SOLARIS

1. **NIS 서비스 데몬 구동 여부 확인**

    ```bash
    # svcs -a | grep nis
    ```

2. **NIS 관련 서비스 데몬 확인**

    ```bash
    # svcs -a | grep nis
    ```

3. **NIS 서비스 데몬 중지**

    ```bash
    # svcadm disable <서비스 데몬>
    ```

### LINUX

1. **NIS 관련 서비스 데몬 활성화 여부 확인**

    ```bash
    # systemctl list-units --type=service | grep –E “ypserv|ypbind|ypxfrd|rpc.yppasswdd|rpc.ypupdated”
    ```

2. **NIS 관련 서비스 데몬 중지**

    ```bash
    # systemctl stop <서비스명>
    ```

3. **NIS 관련 서비스 데몬 비활성화**

    ```bash
    # systemctl disable <서비스명>
    ```

!!! info "참고"
    Redhat 계열 리눅스는 RHEL 8 버전부터 NIS(yp rpms) 패키지가 제거되었음

### AIX

#### process 점검

1. **NIS 관련 서비스 데몬 활성화 여부 확인**

    ```bash
    # ps -ef | grep -E “ypserv|ypbind|ypxfrd|rpc.yppasswdd|rpc.ypupdated”
    ```

2. **NIS 관련 서비스 중지**

    ```bash
    # kill –9 <PID>
    ```

3. **NIS 관련 서비스 시동 스크립트 위치 확인**

    ```bash
    # ls -al /etc/rc.d/rc*.d/* | grep –E “ypserv|ypbind|ypxfrd|rpc.yppasswdd|rpc.ypupdated”
    ```

4. **NIS 관련 서비스 시동 스크립트 이름 변경**

    ```bash
    # mv /etc/rc.d/rc2.d/S73ypbind /etc/rc.d/rc2.d/_S73ypbind
    ```

#### service 점검

1. **NIS 관련 서비스 데몬 활성화 여부 확인**

    ```bash
    # lssrc -a | grep -E “ypserv|ypbind|ypxfrd|rpc.yppasswdd|rpc.ypupdated”
    ```

2. **NIS 관련 서비스 중지**

    ```bash
    # stopsrc -s <NIS 관련 서비스명>
    ```

3. **`/etc/inittab` 파일 수정(주석 처리)**

    ```bash
    #ypserv:2:wait:/usr/lib/netsvc/yp/ypserv >> /dev/console 2>&1
    #ypbind:2:wait:/usr/lib/netsvc/yp/ypbind >> /dev/console 2>&1
    ```

4. **`/etc/inittab` 파일 설정 적용**

    ```bash
    # init q
    ```

### HP-UX

1. **NIS 관련 서비스 데몬 활성화 여부 확인**

    ```bash
    # ps -ef | grep -E “ypserv|ypbind|ypxfrd|rpc.yppasswdd|rpc.ypupdated”
    ```

2. **NIS 관련 서비스 중지**

    ```bash
    # kill -9 <PID>
    ```

3. **`/etc/rc.config.d/namesrvs` 파일 수정**

    ```bash
    NIS_MASTER_SERVER=0
    NIS_SLAVE_SERVER=0
    NIS_CLIENT_SERVER=0
    ```

---

#### NIS 관련 서비스 데몬 설명

| 서비스 | 설명 |
|---|---|
| `ypserv` | master와 slave 서버에서 실행되며 클라이언트로부터의 ypbind 요청에 응답 |
| `ypbind` | 모든 NIS 시스템에서 실행되며 클라이언트와 서버를 바인딩하고 초기화함 |
| `rpc.yppasswdd` | 사용자들이 비밀번호를 변경하기 위해 사용 |
| `ypxfrd` | NIS 마스터 서버에서만 실행되며 고속으로 NIS 맵 전송 |
| `rpc.ypupdated` | NIS 마스터 서버에서만 실행되며 고속으로 암호화하여 NIS 맵 전송 |

