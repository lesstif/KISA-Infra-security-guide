# U-36: r 계열 서비스 비활성화

**분류**: 01_unix

**중요도**: 상

---

01. Unix 서버

UNIX > 3. 서비스 관리

## 개요

### 점검 내용

r-command 서비스 비활성화 여부 점검

### 점검 목적

r-command 사용을 통한 원격 접속은 NET Backup 또는 클러스터링 등 용도로 사용되기도 하나, 인증 없이 관리자 원격 접속이 가능하여 이에 대한 보안 위협을 방지하기 위함

### 보안 위협

rlogin, rsh, rexec 등의 r-command를 이용하여 원격에서 인증 절차 없이 터미널 접속, 쉘 명령어를 실행이 가능한 위험이 존재함

### 참고

!!! info "r-command"
    인증 없이 관리자의 원격 접속을 가능하게 하는 명령어들로 rsh(remsh), rlogin,

rexec, rsync 등이 있음

## 점검 대상 및 판단 기준

### 대상

SOLARIS, LINUX, AIX, HP-UX 등

### 판단 기준

**✅ 양호**: 불필요한 r 계열 서비스가 비활성화된 경우

**❌ 취약**: 불필요한 r 계열 서비스가 활성화된 경우

## 조치 방법

불필요한 r 계열 서비스 중지 및 비활성화 설정

!!! info "NET Backup 등 특별한 용도로 사용하지 않는다면 shell(514), login(513), exec(512) 서비스 중"

지

!!! info "rlogin, rsh, rexec 서비스는 backup, 클러스터링 등의 용도로 종종 사용되고 있으므로 해당 서비"

스 사용 유무를 확인하여 미사용시 서비스 중지

!!! info "/etc/hosts.equiv 또는 $HOME/.rhosts 파일을 통해 해당 서비스 사용 여부 확인 (파일이 존재"

하지 않거나 해당 파일 내에 설정이 없다면 사용하지 않는 것으로 간주)

### 조치 시 영향

일반적인 경우 영향 없음

## 점검 및 조치 사례

### SOLARIS(5.9 이하 버전)

**Step 1) /etc/inetd.conf 파일 내 불필요한 r 계열 서비스 활성화 여부 확인**

# vi /etc/inetd.conf

**Step 2) 불필요한 r 계열 서비스 관련 필드 주석처리**

예시) #shell  stream  tcp   nowait  root  /usr/sbin/in.rshd    in.rshd

**Step 3) 서비스 재시작**

# kill -HUP [inetd PID]

### SOLARIS(5.10 이상 버전)

**Step 1) 불필요한 r 계열 서비스 활성화 여부 확인**

# inetadm | egrep “shell|rlogin|rexec”

**Step 2) 불필요한 r 계열 서비스 데몬 중지**

# inetadm -d <rcommand 데몬>

### LINUX

**[inetd]**

**Step 1) /etc/inetd.conf 파일 내 불필요한 r 계열 서비스 활성화 여부 확인**

**Step 2) 불필요한 r 계열 서비스 관련 필드 주석 처리**

# vi /etc/inetd.conf 예시) # rlogin  stream  tcp  nowait  root  /usr/sbin/in.rlogind  in.rlogind

**Step 3) inetd 서비스 재시작**

**[xinetd]**

**Step 1) /etc/xinetd.d/<파일 이름> 파일 내 불필요한 r 계열 서비스 활성화 여부 확인**

**Step 2) 불필요한 r 계열 서비스 비활성화**

disable 값을 yes로 수정

**Step 3) 설정 적용 및 서비스 재시작**

# systemctl restart xinetd

**[systemd]**

**Step 1) 불필요한 r 계열 서비스 활성화 여부 확인**

# systemctl list-units --type=service | grep –E “rlogin|rsh|rexec”

**Step 2) 현재 가동되고 있는 r 계열 서비스 중지**

# systemctl stop <서비스 이름>

**Step 3) 불필요한 r 계열 서비스 비활성화**

# systemctl disable <서비스 이름>

01. Unix 서버

### AIX, HP-UX

**[inetd]**

**Step 1) /etc/inetd.conf 파일 내 불필요한 r 계열 서비스 활성화 여부 확인**

**Step 2) 불필요한 r 계열 서비스 관련 필드 주석 처리**

# vi /etc/inetd.conf 예시) #login   stream  tcp6    nowait  root    /usr/sbin/rlogind      rlogind

**Step 3) 변경된 설정 적용**

- AIX : # refresh –s inetd -HP-UX : # inetd -c

**[r-command]**

**Step 1) /etc/inetd.conf 파일 내 불필요한 r 계열 서비스 활성화 여부 확인**

**Step 2) /etc/hosts.equiv, $HOME/.rhosts 파일에 접근을 허용할 사용자 이름 또는 IP주소 설정**

**Step 3) /etc/hosts.equiv, $HOME/.rhosts 파일 권한을  600 이하로 설정**

