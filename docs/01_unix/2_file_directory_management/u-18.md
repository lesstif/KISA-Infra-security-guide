# U-18: /etc/shadow 파일 소유자 및 권한 설정

**분류**: 01_unix

**중요도**: 상

---

UNIX > 2. 파일 및 디렉토리 관리

## 개요

### 점검 내용

/etc/shadow 파일 권한 적절성 여부 점검

### 점검 목적

/etc/shadow 파일을 관리자만 제어할 수 있게 하여 비인가자들의 임의적인 파일 변조를 방지하기 위함

### 보안 위협

/etc/shadow 파일에 저장된 암호화된 해시값을 복호화하여(크래킹) 비밀번호를 탈취할 위험이 존재함

### 참고

!!! info "/etc/shadow"
    시스템에 등록된 모든 계정의 비밀번호를 암호화된 형태로 저장 및 관리하는 파일

## 점검 대상 및 판단 기준

### 대상

SOLARIS, LINUX, AIX, HP-UX 등

### 판단 기준

**✅ 양호**: /etc/shadow 파일의 소유자가 root이고, 권한이 400 이하인 경우

**❌ 취약**: /etc/shadow 파일의 소유자가 root가 아니거나, 권한이 400 이하가 아닌 경우

## 조치 방법

/etc/shadow 파일 소유자 및 권한 변경 설정

### 조치 시 영향

일반적인 경우 영향 없음

## 점검 및 조치 사례

### SOLARIS, LINUX

**Step 1) /etc/shadow 파일 소유자 및 권한 변경**

# chown root /etc/shadow # chmod 400 /etc/shadow

### AIX

**Step 1) /etc/security/passwd 파일 소유자 및 권한 변경**

# chown root /etc/security/passwd # chmod 400 /etc/security/passwd

### HP-UX

**Step 1) /tcb/files/auth/ 디렉터리 소유자 및 권한 변경**

# chown root /tcb/files/auth # chmod 400 /tcb/files/auth

